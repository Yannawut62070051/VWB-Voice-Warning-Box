#include "TM1637.h"
#define CLK 9
#define DIO 8
TM1637 tm1637(CLK,DIO);

int start_sw = 4;
int stop_sw = 3;
int rst_sw = 2;
bool start_en = 0;

unsigned long previousMillis = 0;        
int sec = 0, minn = 0;

int a1 = 0, a2 = 0;
int d1 = 0, d2 = 0;

void display_data(int num1, int num2){
  a1 = num1/10;
  d1 = num1%10;
  a2 = num2/10;
  d2 = num2%10;
  tm1637.display(0,a1);
  tm1637.display(1,d1);
  tm1637.point(true);
  tm1637.display(2,a2);
  tm1637.display(3,d2);
}

void setup() {
  pinMode(start_sw, INPUT_PULLUP);
  pinMode(stop_sw, INPUT_PULLUP);
  pinMode(rst_sw, INPUT_PULLUP);
  display_data(0,0);
}

void loop() {
  unsigned long currentMillis = millis();
  if(digitalRead(start_sw) == 0){
    start_en = 1;
  }
  if(digitalRead(stop_sw) == 0){
    start_en = 0;
  }
  if(digitalRead(rst_sw) == 0){
    start_en = 0;
    minn = 0;
    sec = 0;
  }
 
  if(start_en == 1){
    if(currentMillis - previousMillis >= 1000) {
      display_data(minn,sec);
      sec++;
      if(sec >= 60){
        minn++;
        sec = 0;
      }
      previousMillis = currentMillis;
    }
  }

  if(start_en == 0){
    display_data(minn,sec);
  }

}




